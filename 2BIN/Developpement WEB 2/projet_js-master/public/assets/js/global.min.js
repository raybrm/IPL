let token=undefined;const initialRenderOfComponents=function(){token=localStorage.getItem("token");if(token&&token!=null&&token!="null"){if(window.location.pathname==="/login"||window.location.pathname==="/"){loadDashboard()}else{exitLoading()}return token}else{if(window.location.pathname!=="/login"){disconnect()}else{exitLoading()}}};function failed(a){$(".alert span.message").html(a);$(".alert").fadeIn()}function appendPage(b,a){$("body").append(a);window.history.pushState({pageUrl:window.location.hostname+b},"",b);exitLoading()}function exitLoading(){$("rect").css("transition","1s ease").css("transform","translateY(50px)");$(".body-loader").delay(600).fadeOut()}function activeLoading(){$("rect").attr("style","");$(".body-loader").fadeIn()}function loadDashboard(){if(token==null||window.location.pathname==="/dashboard"){return}var b="type=json&token="+token;var a="/dashboard";$.ajax({url:a,type:"GET",data:b,dataType:"html",timeout:5000,success:function(d,c){$(".spa-body").remove();appendPage(a,d)},error:function(c){console.log(c.responseText)}})}function disconnect(){activeLoading();localStorage.removeItem("token");localStorage.removeItem("user.fullname");localStorage.removeItem("user.pseudo");localStorage.removeItem("user.email");token=undefined;setTimeout(function(){loadLogin()},500)}function loadLogin(){if(token!=null||window.location.pathname==="/login"){return}$(".spa-body").remove();$(".navbar").remove();var b="type=json";var a="/login";$.ajax({url:a,type:"GET",data:b,dataType:"html",timeout:5000,success:function(d,c){appendPage(a,d)},error:function(){initialRenderOfComponents()}})}function loadP4(){var a="token="+localStorage.getItem("token")+"&type=json";$.ajax({url:"/p4",type:"GET",data:a,dataType:"html",timeout:5000,success:function(c,b){setTimeout(function(){$(".spa-body").remove();$(".modal-backdrop").remove();appendPage("/p4",c)},500)},error:function(b){failed(b)}})}function exitLoading(){$("rect").css("transition","1s ease").css("transform","translateY(50px)");$(".body-loader").delay(600).fadeOut()}$(document).ready(function(){token=initialRenderOfComponents();$(".alert button.close").click(function(){$(".alert").fadeOut()})});