$(document).ready(function(){$("title").html("Connexion");var m="^[a-zA-Z0-9._]+@[a-zA-Z0-9.]+.[a-z]+$";var c=new RegExp(m);var i="^.{2,}$";var d=new RegExp(i);var b="^[a-zA-Z0-9]{2,}";var e=new RegExp(b);var g="^[A-Za-z ]{2,}";var k=new RegExp(g);$(".veen .rgstr-btn button").click(function(){$(".veen .wrapper").addClass("move");$(".body-login").css("background","#ff59cd");$(".veen .login-btn button").removeClass("active");$(this).addClass("active");j()});$(".veen .login-btn button").click(function(){$(".veen .wrapper").removeClass("move");$(".body-login").css("background","#ff4931");$(".veen .rgstr-btn button").removeClass("active");$(this).addClass("active");j()});function j(){$("form input").css("border-color","#999");$("form input").val("")}$("form#login").submit(function(q){q.preventDefault();var p=0;var o=$("#login .mail input");if(!c.test(o.val())){o.css("border-color","#ff4931")}else{o.css("border-color","#50c355");p++}var n=$("#login .passwd input");if(!d.test(n.val())){n.css("border-color","#ff4931")}else{n.css("border-color","#50c355");p++}if(p==2){f(o.val(),n.val())}});function f(o,n){var p="email="+o+"&passwd="+n;$.ajax({url:"/api/login",type:"POST",data:p,dataType:"json",timeout:5000,success:function(r,q){if(r.success==="true"&&q==="success"){h(r.data)}else{a("form#login",r.message)}},error:function(){a("form#login","Erreur de chargement.")}})}$("form#register").submit(function(s){s.preventDefault();var q=0;var p=$("#register .name input");if(!k.test(p.val())){p.css("border-color","#ff4931")}else{p.css("border-color","#50c355");q++}var o=$("#register .mail input");if(!c.test(o.val())){o.css("border-color","#ff4931")}else{o.css("border-color","#50c355");q++}var r=$("#register .uid input");if(!k.test(r.val())){r.css("border-color","#ff4931")}else{r.css("border-color","#50c355");q++}var n=$("#register .passwd input");if(!d.test(n.val())){n.css("border-color","#ff4931")}else{n.css("border-color","#50c355");q++}if(q==4){l(p.val(),o.val(),r.val(),n.val())}});function l(p,o,r,n){var q="fullname="+p+"&email="+o+"&pseudo="+r+"&passwd="+n;$.ajax({url:"/api/register",type:"POST",data:q,dataType:"json",timeout:5000,success:function(t,s){if(t.success==="true"&&s==="success"){h(t.data)}else{a("form#register",t.message)}},error:function(){a("form#register","Erreur de chargement.")}})}function h(n){localStorage.setItem("token",n.token);localStorage.setItem("user.pseudo",n.user.pseudo);localStorage.setItem("user.fullname",n.user.fullname);localStorage.setItem("user.email",n.user.email);localStorage.setItem("user.descript",n.user.descript);token=n.token;$(".alert").fadeOut();$(".body-login").css("background","#50c355");$(".veen").css("margin-top","300vh");setTimeout(function(){activeLoading();setTimeout(function(){loadDashboard()},500)},500)}function a(o,n){$(o+" input").css("border-color","#ff4931");failed(n)}});